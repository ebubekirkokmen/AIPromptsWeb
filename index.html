<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI PROMPT STUDIO | AIPROMPTS.COM.TR</title>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // SENİN VERDİĞİN CONFİG BİLGİLERİ
        const firebaseConfig = {
            apiKey: "AIzaSyAb-ARofE-z3kHIL_HbnX1LBWt0dSmmWO4",
            authDomain: "aipromptsweb.firebaseapp.com",
            projectId: "aipromptsweb",
            storageBucket: "aipromptsweb.firebasestorage.app",
            messagingSenderId: "68703294254",
            appId: "1:68703294254:web:23d0c00be1659b16a360bf"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Global hale getirelim ki aşağıdaki scriptler erişsin
        window.auth = auth;
        window.db = db;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.signOut = signOut;
        window.addDoc = addDoc;
        window.collection = collection;
        window.serverTimestamp = serverTimestamp;
        window.query = query;
        window.where = where;
        window.getDocs = getDocs;
        window.orderBy = orderBy;
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #39FF14; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #030303; color: #ffffff; min-height: 100vh; margin: 0; overflow-x: hidden; }
        .neon-text { color: var(--neon); text-shadow: 0 0 20px rgba(57, 255, 20, 0.4); }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .grid-bg { background-image: radial-gradient(rgba(57, 255, 20, 0.1) 1px, transparent 0); background-size: 40px 40px; }
        .category-btn { transition: all 0.4s; border: 1px solid rgba(255, 255, 255, 0.1); cursor: pointer; }
        .category-btn.active { background: var(--neon); color: #000; border-color: var(--neon); font-weight: 800; }
        .modal { transition: opacity 0.3s ease, visibility 0.3s ease; opacity: 0; visibility: hidden; position: fixed; inset: 0; z-index: 50; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.9); padding: 20px; }
        .modal.active { opacity: 1; visibility: visible; }
        .input-field { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 12px; padding: 12px; width: 100%; outline: none; }
    </style>
</head>
<body class="grid-bg">

    <nav class="max-w-7xl mx-auto flex justify-between items-center py-6 px-6">
        <div class="flex flex-col cursor-pointer" onclick="location.reload()">
            <span class="text-2xl font-extrabold italic tracking-tighter neon-text">AIPROMPTS.COM.TR</span>
            <span class="text-[9px] tracking-[0.4em] text-gray-500 uppercase mt-1 italic">Bekir Kökmen Production</span>
        </div>
        
        <div id="authStatus" class="flex items-center gap-4">
            <button onclick="toggleModal('loginModal')" class="text-[10px] font-bold text-gray-400 hover:text-white uppercase tracking-widest">Giriş Yap</button>
            <button onclick="toggleModal('registerModal')" class="bg-white/5 border border-white/10 px-5 py-2 rounded-full text-[10px] font-bold text-white hover:bg-[#39FF14] transition-all uppercase tracking-widest">Kayıt Ol</button>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto text-center pt-10 pb-20 px-6">
        <h1 class="text-6xl md:text-8xl font-black italic uppercase leading-none mb-6 tracking-tighter">
            PROMPT <br> <span class="neon-text">FACTORY</span>
        </h1>

        <div class="flex flex-wrap justify-center gap-4 mb-10">
            <button onclick="setCategory('visual', this)" class="category-btn active px-6 py-3 rounded-xl text-[10px] uppercase font-bold tracking-widest">Visual Art</button>
            <button onclick="setCategory('finance', this)" class="category-btn px-6 py-3 rounded-xl text-[10px] uppercase font-bold tracking-widest">Finance</button>
            <button onclick="setCategory('code', this)" class="category-btn px-6 py-3 rounded-xl text-[10px] uppercase font-bold tracking-widest">Dev Mode</button>
        </div>

        <div class="glass p-2 rounded-[40px] shadow-3xl mb-10">
            <div class="bg-[#080808] rounded-[38px] p-8 md:p-10">
                <textarea id="userInput" placeholder="Hangi fikir üzerine prompt yazalım kanka?" class="w-full bg-transparent text-xl md:text-2xl font-light text-white outline-none h-32 resize-none"></textarea>
                <button onclick="generateSuperPrompt()" class="w-full mt-6 bg-[#39FF14] text-black font-black py-5 rounded-2xl uppercase tracking-widest text-lg">Sihri Başlat →</button>
            </div>
        </div>

        <div id="sonucAlani" class="hidden text-left space-y-6">
            <div class="glass p-8 rounded-[35px] border border-[#39FF14]/20">
                <p id="finalPromptText" class="text-lg text-gray-200 italic font-light leading-relaxed mb-6"></p>
                <button onclick="copyToClipboard()" class="w-full bg-white text-black py-4 rounded-xl font-bold uppercase tracking-widest text-sm">Sonucu Kopyala</button>
            </div>
        </div>

        <div id="historySection" class="hidden mt-20 text-left">
            <h3 class="text-xl font-black italic mb-6 neon-text uppercase">Prompt Geçmişim</h3>
            <div id="historyList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </div>
    </main>

    <div id="loginModal" class="modal">
        <div class="glass max-w-md w-full p-10 rounded-[40px] text-center">
            <h2 class="text-2xl font-black neon-text mb-8 italic">GİRİŞ YAP</h2>
            <div class="space-y-4">
                <input type="email" id="loginEmail" class="input-field" placeholder="E-Posta">
                <input type="password" id="loginPass" class="input-field" placeholder="Şifre">
                <button onclick="handleLogin()" class="w-full bg-[#39FF14] text-black font-black py-4 rounded-xl uppercase">Giriş Yap</button>
                <button onclick="toggleModal('loginModal')" class="text-xs text-gray-500 underline">Kapat</button>
            </div>
        </div>
    </div>

    <div id="registerModal" class="modal">
        <div class="glass max-w-md w-full p-10 rounded-[40px] text-center">
            <h2 class="text-2xl font-black neon-text mb-8 italic">KAYIT OL</h2>
            <div class="space-y-4">
                <input type="email" id="regEmail" class="input-field" placeholder="E-Posta">
                <input type="password" id="regPass" class="input-field" placeholder="Şifre">
                <button onclick="handleRegister()" class="w-full bg-[#39FF14] text-black font-black py-4 rounded-xl uppercase">Kayıt Ol</button>
                <button onclick="toggleModal('registerModal')" class="text-xs text-gray-500 underline">Kapat</button>
            </div>
        </div>
    </div>

    <script>
        let currentCategory = 'visual';

        function toggleModal(id) { document.getElementById(id).classList.toggle('active'); }
        function setCategory(cat, btn) {
            currentCategory = cat;
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        async function handleRegister() {
            const email = document.getElementById('regEmail').value;
            const pass = document.getElementById('regPass').value;
            try {
                await window.createUserWithEmailAndPassword(window.auth, email, pass);
                alert("Hoş geldin kanka! Kayıt başarılı.");
                location.reload();
            } catch (e) { alert("Hata: " + e.message); }
        }

        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const pass = document.getElementById('loginPass').value;
            try {
                await window.signInWithEmailAndPassword(window.auth, email, pass);
                location.reload();
            } catch (e) { alert("Hata: " + e.message); }
        }

        function handleLogout() {
            window.signOut(window.auth).then(() => location.reload());
        }

        // Oturum Kontrolü
        window.addEventListener('load', () => {
            setTimeout(() => {
                window.onAuthStateChanged(window.auth, (user) => {
                    if (user) {
                        document.getElementById('authStatus').innerHTML = `<button onclick="handleLogout()" class="text-[10px] font-bold text-red-500 uppercase tracking-widest">Çıkış Yap</button>`;
                        document.getElementById('historySection').classList.remove('hidden');
                        loadHistory(user.uid);
                    }
                });
            }, 1000);
        });

        async function generateSuperPrompt() {
            const input = document.getElementById('userInput').value;
            if(!input) return;

            let final = "";
            if(currentCategory === 'visual') final = `Professional Art Prompt: ${input}, ultra-detailed, 8k, realistic lighting.`;
            else if(currentCategory === 'finance') final = `Finansal Analiz İstemi: ${input}. Lütfen riskleri ve fırsatları detaylandır.`;
            else final = `Code Optimization Request: ${input}. Clean code principles apply.`;

            document.getElementById('finalPromptText').innerText = final;
            document.getElementById('sonucAlani').classList.remove('hidden');

            const user = window.auth.currentUser;
            if(user) {
                await window.addDoc(window.collection(window.db, "prompts"), {
                    uid: user.uid,
                    input: input,
                    output: final,
                    category: currentCategory,
                    createdAt: window.serverTimestamp()
                });
                loadHistory(user.uid);
            }
        }

        async function loadHistory(uid) {
            const q = window.query(window.collection(window.db, "prompts"), window.where("uid", "==", uid), window.orderBy("createdAt", "desc"));
            const snap = await window.getDocs(q);
            const list = document.getElementById('historyList');
            list.innerHTML = "";
            snap.forEach(doc => {
                const d = doc.data();
                const div = document.createElement('div');
                div.className = "glass p-4 rounded-2xl text-[10px]";
                div.innerHTML = `<div class="text-[#39FF14] font-bold uppercase mb-1">${d.category}</div><div class="text-gray-400 italic">"${d.input.substring(0,60)}..."</div>`;
                list.appendChild(div);
            });
        }

        function copyToClipboard() {
            const txt = document.getElementById('finalPromptText').innerText;
            navigator.clipboard.writeText(txt);
            alert("Prompt kopyalandı kanka!");
        }
    </script>
</body>
</html>